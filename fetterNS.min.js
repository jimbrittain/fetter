"use strict";var adr=__imns("util.tools"),uc=__imns("util.classes"),udb=__imns("util.debug");"fetter"in adr||(adr.unfetter=function(a,b,c,d){var e=__imns("util.tools"),f=__imns("util.validation"),g=__imns("util.classes"),h=e.unfetter.prototype.eventChooser(a,b),i=e.unfetter.prototype.functionChooser(a),j=null;if(null===i)return!1;var k=!1;if(d=void 0===d||d!==!1,f.isArray(c)&&2===c.length&&(j=c[0],c=c[1]),null!==c&&"function"==typeof c){c=(new g.FetterMain).findListener(c,a,b,j);try{k=i.call?i.call(a,h,c,d):i(h,c,d)}catch(b){k=!(!a.detachEvent||a.detachEvent!==i)&&a.detachEvent(h,c)}}else try{k=i.call?i.call(a,h,d):a.fun(h,d)}catch(b){k=!(!a.detachEvent||i!==a.detachEvent)&&a.detachEvent(h)}(new g.FetterMain).removeListenerFromIndex((new g.FetterMain).findListenerIndex(c,a,b,j))},adr.unfetter.prototype.eventChooser=function(a,b){return"removeEventListener"in a?b:"detachEvent"in a||"on"+b in a?"on"+b:null},adr.unfetter.prototype.functionChooser=function(a){var b=__imns("util.classes");return"removeEventListener"in a?a.removeEventListener:"detachEvent"in a?a.detachEvent:"onload"in a?(new b.FetterMain).findElement(a).remove:null},adr.fetter=function(a,b,c,d,e,f){var g=__imns("util.tools"),h=__imns("util.classes"),i=__imns("util.validation"),j=(__imns("util.dom"),g.fetter.prototype),k=null,l=null,m=null,n=!0,o=!1,p=null,q=null;if(null===a||"object"!=typeof a||i.isHTMLElement(a)||a===window||a===document?(k=i.isHTMLElement(a)||a===window||a===document?a:null,l=b,m=null!==c&&"function"==typeof c?c:null,null!==c&&i.isArray(c)&&2===c.length&&(q=c[0],m=c[1]),n=d!==!1,o=j.returnDoneNumber(e)):(k="_element"in a&&(i.isHTMLElement(a._element)||a._element===window||a._element===document)?a._element:null,l="_event"in a?a._event:null,m="_function"in a&&"function"==typeof a._function?a._function:null,"_function"in a&&i.isArray(a._function)&&2===a._function.length&&(q=a._function[0],m=a._function[1]),n=!("_bubble"in a&&a._bubble===!1),o="_done"in a?j.returnDoneNumber(a._done):1,p="_done_function"in a&&"function"==typeof a._done_function?a._done_function:null),null!==k&&null!==l&&null!==m){m=(new h.FetterMain).findListener(m,k,l,q),l=l.split(" ");for(var r=0,s=0;s<l.length;s+=1){var t=null;if(2!==o&&3!==o||(null!==p?p()?m():t=j.eventChooser(k,l[s]):"load"===l[s]&&k===window?j.windowOpened()?m():t=j.eventChooser(k,l[s]):"CSSContentRendered"===l[s]&&k===document?(new h.CSSRendered).hasRendered()?m():t=j.eventChooser(k,l[s]):"DOMContentLoaded"===l[s]&&k===document&&(j.documentReady()?m():t=j.eventChooser(k,l[s]))),1!==o&&3!==o||null!==t||(t=j.eventChooser(k,l[s])),null!==t)try{var u=j.functionChooser(k);null!==u&&(u.call?u.call(k,t,m,n):u(k,t,m,n),r+=1)}catch(a){k.attachEvent&&u===k.attachEvent&&k.attachEvent(t,m,n)}}return r===l.length}return!1},adr.fetter.prototype.eventChooser=function(a,b){return"addEventListener"in a?b:"attachEvent"in a||"on"+b in a?"on"+b:null},adr.fetter.prototype.functionChooser=function(a){var b=__imns("util.classes");return a.addEventListener?a.addEventListener:a.attachEvent?a.attachEvent:a.onload?(new b.FetterMain).findElement(a).set:null},adr.fetter.prototype.documentReadyConfirmed=function(){var a=__imns("util.tools");a.fetter.prototype._documentready=!0},adr.fetter.prototype.windowLoadConfirmed=function(){var a=__imns("util.tools");a.fetter.prototype._windowloaded=!0},adr.fetter.prototype.returnDoneNumber=function(a){return a="both"===a?3:a,a="after"===a?2:a,a=2===a||3===a?a:1},adr.fetter.prototype.windowOpened=function(){var a=__imns("util.tools"),b=a.fetter.prototype;if(b._windowloaded)return b._windowloaded;var c=!1;if(!document.readyState||"complete"!==document.readyState&&"loaded"!==document.readyState?"loaded"in window&&(c=window.loaded):c=!0,c)b._windowloaded=!0;else{var d=b.functionChooser(window);null!==d&&d("load",b.windowLoadConfirmed,!0)}return c},adr.fetter.prototype.documentReady=function(){var a=__imns("util.tools"),b=a.fetter.prototype,c=null;if(b._documentready)return b._documentready;var d=!1;if(document.attachEvent&&document.documentElement)try{document.documentElement.doScroll("left"),d=!0}catch(a){}else("complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState||document.attachEvent&&"loading"!==document.readyState)&&(d=!0);return d?(b._documentready=!0,!0):(c=b.functionChooser(document),null!==c&&c("DOMContentLoaded",b.documentReadyConfirmed,!0),c=b.functionChooser(window),null!==c&&c("load",b.documentReadyConfirmed,!0),!1)},uc.FetterMain=function(){var a=__imns("util.classes");return a.FetterMain.prototype.singletonInstance?a.FetterMain.prototype.singletonInstance:(a.FetterMain.prototype.singletonInstance=this,this.fetter_array=[],void(this.listener_array=[]))},uc.FetterMain.prototype.findListenerIndex=function(a,b,c,d){d=void 0===d?null:d;var e=-1,f=0,g=0;if("function"==typeof a){for(f=0,g=this.listener_array.length;f<g;f+=1)if(this.listener_array[f]._function===a){e=f;break}if(e===-1){var h=this.listener_array.length;for(f=0;f<h;f+=1)if(this.listener_array[f]._function.toString()===a.toString()&&this.listener_array[f]._element===b&&this.listener_array[f]._event===c&&d===this.listener_array[f]._funattacher){e=f;break}}return e}return void(new udb.IMDebugger).pass("Fetter must be supplied with a function")},uc.FetterMain.prototype.removeListenerFromIndex=function(a){a>-1&&a<this.listener_array.length&&this.listener_array.splice(a,1)},uc.FetterMain.prototype.findListener=function(a,b,c,d){var e=__imns("util.classes");d=void 0===d?null:d;var f=this.findListenerIndex(a,b,c,d);return f===-1?(this.listener_array.push(new e.FetterListener(a,b,c,d)),this.listener_array[this.listener_array.length-1]._listener):this.listener_array[f]._listener},uc.FetterMain.prototype.findElementNumber=function(a){for(var b=-1,c=0,d=this.fetter_array.length;c<d;c+=1)if(this.fetter_array[b].element===a){b=c;break}return b},uc.FetterMain.prototype.findElement=function(a){var b=__imns("util.tools"),c=this.findElementNumber(a);return c===-1&&(c=this.fetter_array.length,this.fetter_array.push(new b.FetterDefinition(a))),this.fetter_array[c]},uc.FetterMain.prototype.isElement=function(a){var b=this.findElementNumber(a);return b!==-1},uc.FetterDefinition=function(){this.element=null,this.event_array=null},uc.FetterDefinition.prototype.init=function(a){this.element=a,this.event_array=[]},uc.FetterDefinition.prototype.returnEventObject=function(a){for(var b=!1,c=0,d=this.event_array.length;c<d;c+=1)if(this.event_array[c]._event===a)return b=this.event_array[c],this.event_array[c];return b},uc.FetterDefinition.prototype.sendToTheFront=function(a,b){var c=this.returnEventObject(this.returnEvent(a));if(c.functionExists(b)){var d=c.findFunctionNumber(b),e=c._function_arr.splice(d,1);c._function_arr.unshift(e)}},uc.FetterDefinition.prototype.sendToTheBack=function(a,b){var c=this.returnEventObject(this.returnEvent(a));if(c.functionExists(b)){var d=c.findFunctionNumber(b),e=c._function_arr.splice(d,1);c._function_arr.push(e)}},uc.FetterDefinition.prototype.set=function(a,b,c){var d=this.returnEventObject(this.returnEvent(a)),e=__imns("util.classes");if(d instanceof e.FetterEvent)return!d.functionExists(b)&&(d._function_arr.push(b),!0)},uc.FetterDefinition.prototype.remove=function(a,b){var c=this.returnEventObject(this.returnEvent(a)),d=__imns("util.classes");if(c instanceof d.FetterEvent){if(c.functionExists(b)){var e=c.findFunctionNumber(b);return this.eveObj._function_arr.splice(e,1),!0}return!1}return!1},uc.FetterListener=function(a,b,c,d){var e=this;this._function="function"==typeof a?a:function(){},this._funattacher=void 0!==d?d:null,this._element=null!==b?b:-1,this._event=null!==c?c:-1,this._listener=function(a){return e._function(a)}},uc.FetterEvent=function(){this._element=null,this._event=null,this._bubble=!0,this._function_arr=null},uc.FetterEvent.prototype.process=function(a){for(var b=0,c=this._function_arr.length;b<c;b+=1)"function"==typeof this._function_arr[b]&&this._function_arr[b](a)},uc.FetterEvent.prototype.functionExists=function(a){var b=this.findFunctionNumber(a);return b!==-1},uc.FetterEvent.prototype.findFunctionNumber=function(a){for(var b=-1,c=0,d=this._function_arr.length;c<d;c+=1)if(this._function_arr[c]===a){b=c;break}return b},uc.FetterEvent.prototype.findFunction=function(a){var b=this.findFunctionNumber(a);return b!==-1&&this._function_arr[b]});